   <div class="wrap" *ngIf="pres() as p">
    <!-- Header / breadcrumbs -->
    <header class="topbar">
      <nav class="crumbs">
        <a (click)="back()">‚Üê Presentaciones</a>
        <span>/</span>
        <span>#{{ p.id }}</span>
      </nav>
  
      <div class="rhs">
        <span class="muted">Col: {{ p.collection_id }}</span>
        <span class="dot"></span>
        <span class="muted">Actualizado: {{ p.updated_at | date:'short' }}</span>
      </div>
    </header>
  
    <!-- estados -->
    <div *ngIf="error()" class="status error">{{ error() }}</div>
    <div *ngIf="loading()" class="status busy"><span class="dot"></span> Cargando‚Ä¶</div>
  
    <!-- Hero -->
    <section class="hero card">
      <div class="cover" [class.placeholder]="!p.cover">
        <img *ngIf="p.cover" [src]="p.cover" alt="cover" />
        <div class="no-cover" *ngIf="!p.cover">Sin portada</div>
        <div class="overlay">
          <label class="btn ghost">
            Cambiar portada
            <input type="file" accept="image/*" (change)="onCoverChange($event)" hidden />
          </label>
          <button class="btn ghost" (click)="clearCover()" [disabled]="!hasCover()">Quitar</button>
        </div>
      </div>
  
      <div class="meta">
        <form [formGroup]="editForm" (ngSubmit)="saveMeta()">
          <input class="title" type="text" formControlName="title" [readonly]="saving()" />
          <textarea
            class="desc"
            rows="3"
            formControlName="description"
            placeholder="Descripci√≥n‚Ä¶"
          ></textarea>
          <div class="actions">
            <button class="btn primary" type="submit" [disabled]="saving() || editForm.invalid">
              Guardar
            </button>
            <span class="saving" *ngIf="saving()">Guardando‚Ä¶</span>
          </div>
        </form>
      </div>
    </section>
  
    <!-- Assets header -->
    <section class="assets-head">
      <h2>Recursos ({{ assets().length }})</h2>
      <div class="adder">
        <!-- ‚ùóÔ∏èsignals + ngModel -->
        <select [ngModel]="newKind()" (ngModelChange)="newKind.set($event)" name="kind">
          <option value="image">Imagen</option>
          <option value="video">Video</option>
          <option value="ppt">PPT</option>
          <option value="link">Link</option>
          <option value="text">Texto</option>
        </select>
  
        <ng-container [ngSwitch]="newKind()">
          <div *ngSwitchCase="'image'">
            <input id="asset-file" type="file" accept="image/*" (change)="onFileChange($event)" />
          </div>
          <div *ngSwitchCase="'video'">
            <input id="asset-file" type="file" accept="video/*" (change)="onFileChange($event)" />
          </div>
          <div *ngSwitchCase="'ppt'">
            <input
              id="asset-file"
              type="file"
              accept=".ppt,.pptx,.pdf"
              (change)="onFileChange($event)"
            />
          </div>
          <div *ngSwitchCase="'link'">
            <input
              type="url"
              placeholder="https://‚Ä¶"
              [ngModel]="newUrl()"
              (ngModelChange)="newUrl.set($event)"
              name="assetUrl"
            />
          </div>
          <div *ngSwitchCase="'text'">
            <input
              type="text"
              placeholder="Nota / pie de foto‚Ä¶"
              [ngModel]="newText()"
              (ngModelChange)="newText.set($event)"
              name="assetText"
            />
          </div>
        </ng-container>
  
        <button class="btn" (click)="addAsset()" [disabled]="saving()">Agregar</button>
      </div>
    </section>
  
    <!-- Assets grid -->
    <section class="assets-grid" *ngIf="assets().length; else emptyAssets">
      <article class="asset card" *ngFor="let a of assets()">
        <div class="thumb" [class.placeholder]="!isMedia(a)">
          <img *ngIf="a.kind === 'image' && a.filePath" [src]="a.filePath" alt="img" />
          <video *ngIf="a.kind === 'video' && a.filePath" [src]="a.filePath" controls></video>
          <div class="ext" *ngIf="a.kind === 'ppt'">PPT</div>
          <a
            class="link"
            *ngIf="a.kind === 'link' && a.url"
            [href]="a.url"
            target="_blank"
            rel="noopener"
          >
            Abrir enlace
          </a>
          <div class="text" *ngIf="a.kind === 'text'">
            {{ a.metaJson?.caption || '(texto)' }}
          </div>
          <span class="badge">{{ kindIcon(a) }} {{ a.kind }}</span>
        </div>
  
        <div class="ainfo">
          <div class="row">
            <span class="muted">#{{ a.id }}</span>
            <span class="dot"></span>
            <span class="muted">{{ a.createdAt | date: 'short' }}</span>
            <button class="btn danger right" (click)="deleteAsset(a)" [disabled]="saving()">
              Eliminar
            </button>
          </div>
  
          <!-- Archivo local -->
          <div class="row small" *ngIf="a.filePath">
            Archivo local:
            <code>{{ a.filePath }}</code>
          </div>
  
          <!-- URL S3 (puede dar AccessDenied, pero la dejamos como dato t√©cnico) -->
          <div class="row small" *ngIf="a.url">
            URL (S3 / descarga t√©cnica):
            <a [href]="a.url" target="_blank" rel="noopener">{{ a.url }}</a>
          </div>
  
          <!-- üîπ Enlace principal: abrir/descargar en Presenton -->
          <div
            class="row small"
            *ngIf="a.kind === 'ppt' && a.metaJson?.edit_path as editUrl"
          >
            Abrir / descargar en Presenton:
            <a [href]="editUrl" target="_blank" rel="noopener">
              Abrir en Presenton
            </a>
          </div>
        </div>
      </article>
    </section>
  
    <ng-template #emptyAssets>
      <div class="empty">
        <div class="title">A√∫n no hay recursos</div>
        <div class="muted">Agrega im√°genes, PPTs, links o notas para esta presentaci√≥n.</div>
      </div>
    </ng-template>
  </div>
  
  <!-- Fallback si no hay pres (por error) -->
  <div class="wrap" *ngIf="!pres() && !loading()">
    <div class="status error">No se encontr√≥ la presentaci√≥n.</div>
    <button class="btn" (click)="back()">Volver</button>
  </div>
  