:host{
  --ink:#2b2623; --muted:#7a5c4d; --accent:#85586f; --paper:#fffcf7; --bg:#f6efe9;
  display:block; background:var(--bg);
}

.wrap{ width:min(1120px,92vw); margin:0 auto; padding:1rem 1rem 2rem; }

/* Top bar */
.top-bar{
  position:sticky; top:0; z-index:30;
  display:flex; align-items:center; gap:.75rem;
  background: color-mix(in oklab, var(--paper) 90%, transparent);
  backdrop-filter:saturate(140%) blur(6px);
  border:1px solid rgba(0,0,0,.05);
  border-radius:14px;
  padding:.6rem .9rem; margin:0 0 1rem;
}
.top-bar .title{ font-weight:800; color:var(--ink); }
.top-bar .spacer{ flex:1; }

/* Botones base */
.btn{
  border:1px solid rgba(0,0,0,.12);
  background:#fff; color:var(--ink);
  padding:.48rem .85rem; border-radius:10px;
  cursor:pointer; line-height:1; transition:.15s background;
}
.btn:hover{ background:#faf7f3; }
.btn.light{ background:#f2f2f2; }
.btn.primary{ background:var(--accent); color:#fff; border-color:var(--accent); }
.btn.ghost{ background:transparent; border-color:#d7cfc8; }
.btn:disabled{ opacity:.55; cursor:not-allowed; }
.btn.tiny{ font-size:.85rem; padding:.3rem .55rem; border-radius:8px; }

/* Sub-búsqueda (coincide con tu HTML .subsearch / .row / .inp) */
.subsearch{
  background: color-mix(in oklab, var(--paper) 85%, transparent);
  border:1px solid #eee4dc; border-radius:14px;
  padding:.75rem; margin: .25rem 0 .75rem;
}
.subsearch .row{
  display:grid; gap:.5rem; align-items:center; margin-bottom:.5rem;
  grid-template-columns: 1.2fr 160px 120px 120px;   /* 1ª fila por defecto */
}
.subsearch .row:nth-child(2){
  grid-template-columns: 1fr 120px auto auto auto; /* 2ª fila: tags + botones */
}
.subsearch .row:nth-child(3){ grid-template-columns: 1fr; }
.inp{
  height:38px; border-radius:10px; border:1px solid #e6e0da;
  background:#fff; padding:.45rem .7rem; outline:none; color:var(--ink);
}
textarea.inp{ height:72px; font-family:ui-monospace,Menlo,monospace; font-size:.86rem; }

/* Barra de selección */
.select-bar{
  display:flex; gap:1rem; align-items:center; flex-wrap:wrap;
  margin:.25rem 0 1rem;
}
.select-bar .spacer{ flex:1; }
.select-bar b{ color:var(--ink); }

/* Grid de tarjetas */
.grid{
  display:grid; gap:1rem;
  grid-template-columns: repeat(auto-fill, minmax(260px,1fr));
}
.card{
  position:relative; background:#fff;
  border:1px solid #eee4dc; border-radius:16px; padding:.75rem;
  box-shadow:0 4px 16px rgba(0,0,0,.04);
  transition:transform .15s, box-shadow .2s, border-color .2s;
}
.card:hover{ transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.08); }
.card:focus-within{ outline:3px solid color-mix(in oklab, var(--accent) 35%, transparent); }

/* Checkbox de selección (coincide con label.sel del HTML) */
.sel{
  position:absolute; top:.6rem; left:.6rem; z-index:2;
  width:20px; height:20px; display:grid; place-items:center;
}
.sel input{ width:18px; height:18px; }

/* Thumb */
.thumb{
  height:160px; border-radius:12px; overflow:hidden;
  display:flex; align-items:center; justify-content:center;
  background:linear-gradient(180deg,#faf7f3,#f3eee9);
  border:1px dashed #e6d9cf;
}
.thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
.thumb.placeholder span{ color:#8a7c74; font-size:.95rem; }

/* Body */
.body{ padding:.5rem .25rem 0; cursor:pointer; }
.stamp-title{ margin:.1rem 0 .15rem; font-size:1.05rem; line-height:1.3; color:var(--ink); font-weight:600; }
.meta{ color:#8a7c74; font-size:.92rem; }

/* Mensajes */
.status.error{ color:#b91c1c; margin:.5rem 0; }
.status.busy{ color:#6b7280; }

/* Vacío */
.empty{ text-align:center; color:var(--muted); padding:2rem 0; }
.empty .title-empty{ font-weight:800; color:var(--ink); margin-bottom:.25rem; }

/* Responsive */
@media (max-width: 900px){
  .subsearch .row{ grid-template-columns: 1fr 1fr 1fr 1fr; }
  .subsearch .row:nth-child(2){ grid-template-columns: 1fr 120px auto auto; }
}
@media (max-width: 640px){
  .subsearch .row{ grid-template-columns: 1fr 1fr; }
  .subsearch .row:nth-child(2){ grid-template-columns: 1fr 1fr; }
}

/* Panel de historia, mismo estilo que subsearch */
.history-panel{
  background: color-mix(in oklab, var(--paper) 85%, transparent);
  border:1px solid #eee4dc;
  border-radius:14px;
  padding:.75rem;
  margin: .25rem 0 .75rem;
}

/* Hacer que la historia ocupe todo el ancho, como Attrs JSON */
.history-panel .row{
  display:grid;
  gap:.5rem;
  grid-template-columns: 1fr;
}

.history-panel .history-label{
  padding-left:.1rem;
  color:var(--ink);
}
